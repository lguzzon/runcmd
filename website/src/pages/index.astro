---
import fs from 'node:fs/promises'
import BaseLayout from '../layouts/BaseLayout.astro'
import Nav from '../components/Nav.astro'

const basePath = Astro.site?.pathname ?? '/runcmd/'
const normalizedBase = basePath === '/' ? '' : basePath.replace(/\/$/, '')

let version = '1.0.0'
try {
  version = (await fs.readFile(new URL('../../../version.txt', import.meta.url), 'utf8')).trim()
} catch {}

const scriptHref = `${normalizedBase}/runcmd.sh`
const githubUrl = 'https://github.com/lguzzon/runcmd'
const docsHref = `${normalizedBase}/docs/#docs`

const features = [
  {
    title: 'Cross-Platform',
    description: 'Write once, run everywhere. Seamless execution on macOS, Linux, and Windows with unified behavior.',
    icon: 'terminal',
  },
  {
    title: 'Zero Config',
    description: 'Automatic runtime installation. Bun is fetched and configured automatically if missing.',
    icon: 'zap',
  },
  {
    title: 'Robust & Safe',
    description: 'Atomic updates, self-healing environment, and smart path resolution for maximum reliability.',
    icon: 'shield',
  },
  {
    title: 'Modern Tooling',
    description: 'Built-in formatting, linting, and JSON validation powered by Biome and Shfmt.',
    icon: 'code',
  },
]
---
<BaseLayout title="RunCmd – Universal Script Runner" description="Write your scripts in JavaScript/TypeScript and run them anywhere with automatic tooling." >
  <div class="min-h-screen">
    <Nav base={normalizedBase} githubUrl={githubUrl} />

    <main id="top">
      <section class="relative overflow-hidden pt-32 pb-16 md:pt-48 md:pb-32">
        <div class="absolute inset-0 pointer-events-none bg-[radial-gradient(circle_at_top,_rgba(59,130,246,0.12),_transparent_45%),radial-gradient(circle_at_30%_20%,_rgba(99,102,241,0.12),_transparent_35%)]"></div>
        <div class="container mx-auto px-4 relative z-10">
          <div class="text-center max-w-4xl mx-auto">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-500/10 text-blue-500 mb-8 font-medium text-sm border border-blue-500/20">
              <span class="relative flex h-2 w-2">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
              </span>
              v{version} is now available
            </div>

            <h1 class="text-5xl md:text-7xl font-bold tracking-tight mb-8 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent dark:from-blue-400 dark:to-indigo-400">
              Universal Script Runner for Modern Devs
            </h1>

            <p class="text-xl text-gray-600 dark:text-gray-300 mb-12 max-w-2xl mx-auto leading-relaxed">
              Write your scripts in JavaScript/TypeScript. Run them anywhere. Automated environment setup, dependency management, and cross-platform compatibility out of the box.
            </p>

            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
              <a href={scriptHref} class="group flex items-center gap-2 px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-blue-500/25">
                <svg class="w-5 h-5 group-hover:-translate-y-1 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="M12 3v14m0 0l-5-5m5 5 5-5" />
                  <path d="M5 19h14" />
                </svg>
                Download Script
              </a>
              <a href={docsHref} class="flex items-center gap-2 px-8 py-4 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-900 dark:text-white rounded-xl font-semibold transition-all">
                Read Documentation
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="m9 18 6-6-6-6" />
                </svg>
              </a>
            </div>
          </div>
        </div>
      </section>

      <section id="features" class="py-24 bg-gray-50/50 dark:bg-gray-900/50">
        <div class="container mx-auto px-4">
          <div class="text-center max-w-3xl mx-auto mb-16">
            <h2 class="text-3xl md:text-4xl font-bold mb-4 text-gray-900 dark:text-white">Everything you need</h2>
            <p class="text-gray-600 dark:text-gray-400 text-lg">
              Stop writing fragile bash scripts. Start building robust automation with the full power of TypeScript.
            </p>
          </div>
          <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
            {features.map((feature) => (
              <div class="p-8 rounded-2xl bg-white dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700 shadow-xl shadow-gray-200/50 dark:shadow-none backdrop-blur-sm" aria-label={feature.title}>
                <div class="w-12 h-12 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 mb-6">
                  {feature.icon === 'terminal' && (
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                      <rect x="3" y="5" width="18" height="14" rx="3" />
                      <path d="M7 10l3 3-3 3M12 17h5" />
                    </svg>
                  )}
                  {feature.icon === 'zap' && (
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                      <path d="M13 2 3 14h7l-1 8 10-12h-7z" />
                    </svg>
                  )}
                  {feature.icon === 'shield' && (
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                      <path d="M12 3 4 6v6c0 5 4 8 8 9 4-1 8-4 8-9V6z" />
                      <path d="m9.5 12.5 1.5 1.5 3.5-3.5" />
                    </svg>
                  )}
                  {feature.icon === 'code' && (
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                      <path d="m8 7-5 5 5 5" />
                      <path d="m16 7 5 5-5 5" />
                      <path d="m14 4-4 16" />
                    </svg>
                  )}
                </div>
                <h3 class="text-xl font-bold mb-3 text-gray-900 dark:text-white">{feature.title}</h3>
                <p class="text-gray-600 dark:text-gray-400 leading-relaxed">{feature.description}</p>
              </div>
            ))}
          </div>
        </div>
      </section>

      <section id="quickstart" class="py-24">
        <div class="container mx-auto px-4 max-w-5xl">
          <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-10">
            <div class="prose prose-lg dark:prose-invert max-w-xl">
              <h2>Quick Start</h2>
              <p>Get running in seconds. Use the commands below, then explore the full documentation for advanced workflows.</p>
              <a href={docsHref} class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 transition-colors">
                Open Documentation
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="m9 18 6-6-6-6" />
                </svg>
              </a>
            </div>
            <div class="flex-1">
              <div class="not-prose bg-gray-900 rounded-xl p-6 mb-6 overflow-x-auto shadow-lg shadow-blue-900/20">
                <div class="text-xs uppercase tracking-wide text-gray-400 mb-3">Install & Run</div>
                <pre class="text-blue-400 text-sm font-mono leading-6 whitespace-pre-wrap">{['curl -fsSL https://lguzzon.github.io/runcmd/runcmd.sh -o runcmd.sh', 'chmod +x runcmd.sh', './runcmd.sh my-script.mjs'].join('\n')}</pre>
              </div>
              <div class="grid gap-6 md:grid-cols-2">
                <div class="p-5 rounded-xl bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 shadow-sm">
                  <h3 class="text-lg font-semibold mb-3 text-gray-900 dark:text-white">Unix / macOS</h3>
                  <ul class="list-disc pl-5 space-y-2 text-gray-600 dark:text-gray-400">
                    <li>Auto-installs Bun to <code>~/.bun</code></li>
                    <li>Safe self-formatting and tooling</li>
                    <li>Cross-platform path resolution</li>
                    <li>Integrated debug timing</li>
                  </ul>
                </div>
                <div class="p-5 rounded-xl bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 shadow-sm">
                  <h3 class="text-lg font-semibold mb-3 text-gray-900 dark:text-white">Windows</h3>
                  <ul class="list-disc pl-5 space-y-2 text-gray-600 dark:text-gray-400">
                    <li>Supports .js, .mjs, .ts, and .py</li>
                    <li>Auto-installs tools via PowerShell</li>
                    <li>Enhanced debug modes (+d, +dd)</li>
                    <li>Delayed variable expansion support</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="py-12 border-t border-gray-200 dark:border-gray-800">
      <div class="container mx-auto px-4 text-center text-gray-600 dark:text-gray-400">
        <p>© {new Date().getFullYear()} RunCmd. Open Source Software.</p>
      </div>
    </footer>
  </div>
</BaseLayout>
